{% extends "randomtest/base.html" %}

{% block content %}
<script type="text/javascript">
function togglemarked() {
    var y=document.getElementById("problems");
    lang=y.elements.length;

    check=0;
    for (i=0;i<lang;i++) {
        if (y.elements[i].name == "chk" && y.elements[i].checked==false) {
            check=1;
        }
    }
    if (check==1) {
        for (i=0;i<lang;i++) {
            y.elements[i].checked=true;
        }
    } else {
        for (i=0;i<lang;i++) {
            y.elements[i].checked=false;
        }
    }
}
function fixchecks() {
    var y=document.getElementById("problems");
    lang=y.elements.length;

    allchecked=1;
    allunchecked=1;
    for (i=0;i<lang;i++) {
        if (y.elements[i].name == "chk") {
            if (y.elements[i].checked==false) {
                allchecked=0;
            } else {
                allunchecked=0;
            }
        }
    }
    z=document.getElementById("toggler");
    if (allchecked==1) {
        z.checked=true;
        z.indeterminate=false;
    } else if (allunchecked==1) {
        z.checked=false;
        z.indeterminate=false;
    } else {
	z.indeterminate=true;
    }
}
</script>

<ol class="breadcrumb">
  <li><a href="/problemgroups/">My Problem Groups</a></li>
  <li class="active">{{name}}</li>
</ol>

<h2>{{name}}</h2>
{% if rows|length > 0 %}


<form action="." method="POST" id="problems">
{% csrf_token %}
<input type="hidden" name="startform" value="{{pk}}">
<table class="table">
<tr>
<td>
<!--<button class="btn btn-default" id="toggler" onclick="togglemarked();">Select/Deselect All</button>-->
 <input type="checkbox" id="toggler" onclick="togglemarked()" checked/>
</td>
<th>
Problem
</th>
</tr>

{% for prob in rows %}
<tr>
<td valign="top"><br>
{{forloop.counter}}.<br>
<input type="checkbox" name="chk" value="{{prob.label}}" onclick="fixchecks()" checked/>
</td>
<td>
{% if prob.question_type_new.question_type == 'multiple choice' %}
{% autoescape off %}{{prob.display_mc_problem_text|linebreaks}} {% endautoescape %}  [{{prob.readable_label}}]<br>
{% else %}
{% autoescape off %}{{prob.display_problem_text|linebreaks}} {% endautoescape %}  [{{prob.readable_label}}]<br>
{% endif %}
</td>
</tr>
{% endfor %}
</table>
<p><button type="submit" class="btn btn-default" name="remove" value="Remove Unselected Problems" />Remove Unselected Problems</button></p>

<p>
Name of test: <input type="text" name="testname" value="New Test" /></p>
<p><button type="submit" class="btn btn-primary" name="newtest" value="newtest">Create test with selected problems</button></p>
</form>
{% else %}
There are no problems currently in this group. Use the <a href="/search/">Search</a> tab to add problems.
{% endif %}

{% endblock %}
